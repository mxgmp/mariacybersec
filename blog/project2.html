<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Project 2 — Detecting DNS Exfiltration with Wireshark</title>
  <meta name="description" content="Detecting DNS exfiltration with Wireshark: simulating normal and suspicious traffic, analyzing packet behavior, and spotting tunneling patterns.">
  <style>
    :root{ 
      --bg:#000000; --fg:#ffffff; --muted:#6b7280; 
      --accent:#c084fc; --card:#2a2a2a; --border:#2a2a2a; 
    }
    html,body{
      margin:0; padding:0; background:var(--bg); color:var(--fg);
      font:15px/1.7 Helvetica, "Helvetica Neue", Arial, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
    .container{ max-width:860px; margin:32px auto 80px; padding:0 16px; }

    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    header{ padding:16px 0; }
    .back{ font-size:14px; color:var(--muted); }

    h1 {
      font-family: "Avenir Next", Avenir, Montserrat, "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: var(--accent);
    }
    h2 {
      font-family: "Avenir Next", Avenir, Montserrat, "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: var(--muted);
    }
    p, li {
      font-family: "Source Code Pro", "Courier New", monospace;
      font-size: 15px;
      line-height: 1.6;
      color: #ffffff;
    }
    .highlight { color: var(--accent); font-weight: 600; }
    code {
      background: var(--card);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: "Source Code Pro", "Courier New", monospace;
      color: var(--accent);
    }
    ul{ margin:8px 0 16px 20px; }
    hr{ border:0; border-top:1px solid var(--border); margin:40px 0; }

    /* gallery + lightbox */
    .muted-text{ color:var(--muted); }
    .project-gallery{ margin-top:28px }
    .project-gallery h2{ color:var(--muted); margin-bottom:6px }
    .img-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(230px,1fr));
      gap:14px;
    }
    .img-grid figure{ margin:0 }
    .img-grid img{
      width:100%; height:auto; display:block; border-radius:10px;
      border:1px solid rgba(192,132,252,.25);
      box-shadow:0 4px 15px rgba(0,0,0,.25);
      cursor:zoom-in; transition:transform .2s ease, box-shadow .2s ease;
    }
    .img-grid img:hover{ transform:scale(1.04); box-shadow:0 8px 28px rgba(192,132,252,.4) }

    .lightbox{
      position:fixed; inset:0; display:none; place-items:center;
      background:rgba(0,0,0,.82); z-index:9999; padding:22px;
    }
    .lightbox.open{ display:grid }
    .lightbox img{
      max-width:min(1200px,92vw); max-height:86vh; border-radius:12px;
      box-shadow:0 10px 40px rgba(0,0,0,.6);
    }
    .lightbox .close{
      position:absolute; top:12px; right:16px; font-size:28px;
      color:#fff; cursor:pointer; line-height:1
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a class="back" href="/" aria-label="Back to home">← mariacybersec</a>
    </header>

    <main class="post">
      <h1>Detecting DNS Exfiltration with Wireshark</h1>

      <p><span class="highlight">DNS tunneling</span> is how attackers exfiltrate data through DNS queries that look normal. In this mini lab, I simulated both normal and suspicious DNS traffic using <span class="highlight">Python + Scapy</span>, then analyzed packet behavior in Wireshark to detect signs of data exfiltration.</p>

      <p>This is the part 2 of my hands-on network forensics series, which is focused on identifying unusual DNS patterns that could indicate <span class="highlight">tunneling or data leaks</span>.</p>

      <hr />

      <h2>1: Generate Simulated DNS Traffic</h2>
      <p>I wrote a short Python script using <code>Scapy</code> to generate a <code>.pcap</code> file containing both <span class="highlight">normal DNS queries</span> and suspicious, <span class="highlight">high entropy subdomains</span> that mimic exfiltration behavior. The file was then exported for Wireshark analysis.</p>

      <hr />

      <h2>2: Analyze the PCAP in Wireshark</h2>
      <p>Opening the <code>project2_dns_tunnel.pcap</code> file, I inspected DNS packets and compared legitimate queries (<code>google.com</code>, <code>github.com</code>, etc.) with the generated suspicious traffic (<code>*.exfil.example</code>).</p>

      <hr />

      <h2>3: Observe Normal DNS Queries</h2>
      <p>Normal traffic showed <span class="highlight">low entropy</span>, human readable domain names and proper DNS responses. These packets represented standard user-initiated lookups.</p>

      <hr />

      <h2>4: Identify Suspicious Patterns</h2>
      <p>Suspicious traffic showed <span class="highlight">unusually long subdomains</span> filled with random characters; a common indicator of DNS tunneling. Many queries had <span class="highlight">no responses</span> or incomplete exchanges, which suggests abnormal activity.</p>

      <hr />

      <h2>5: Compare Entropy & Behavior</h2>
      <p>By visually comparing both patterns, I confirmed how <span class="highlight">tunneled data</span> often looks chaotic compared to ordinary DNS traffic. Even without automation, this manual inspection highlights how analysts can spot covert channels.</p>

      <hr />

      <h2>Conclusion</h2>
      <p>This lab deepened my understanding of how <span class="highlight">exfiltration can hide within legitimate protocols</span>. Hands-on traffic simulation and analysis gave me a clear picture of how DNS tunneling operates and how to identify it visually in Wireshark.</p>

      <hr />

      <!-- === Screenshot gallery (no captions) === -->
      <section class="project-gallery">
        <h2>Screenshots</h2>
        <p class="muted-text">Click any image to zoom.</p>

        <div class="img-grid">
          <figure><img loading="lazy" src="/assets/project2/IMG_5410.jpeg" alt="DNS simulation overview and PCAP ready"></figure>
          <figure><img loading="lazy" src="/assets/project2/IMG_5409.JPG"  alt="Wireshark DNS capture"></figure>
          <figure><img loading="lazy" src="/assets/project2/IMG_5403.jpg"  alt="Normal DNS traffic view"></figure>
          <figure><img loading="lazy" src="/assets/project2/IMG_5404.jpg"  alt="Suspicious long randomized subdomains"></figure>
          <figure><img loading="lazy" src="/assets/project2/IMG_5401.jpg"  alt="DNS tunneling with missing responses"></figure>
          <figure><img loading="lazy" src="/assets/project2/IMG_5402.jpg"  alt="Side-by-side comparison normal vs suspicious"></figure>
        </div>
      </section>

      <p class="muted-text" style="margin-top:18px">
        See the quick summary on Instagram <strong>@maria.cybersec</strong>.
      </p>
    </main>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <span class="close" id="lbClose" aria-label="Close">×</span>
    <img id="lbImg" alt="">
  </div>

  <script>
    (function(){
      const lb = document.getElementById('lightbox');
      const lbImg = document.getElementById('lbImg');
      const lbClose = document.getElementById('lbClose');
      document.querySelectorAll('.img-grid img').forEach(img=>{
        img.addEventListener('click',()=>{
          lbImg.src = img.dataset.full || img.src;
          lbImg.alt = img.alt || '';
          lb.classList.add('open');
          lb.setAttribute('aria-hidden','false');
          document.body.style.overflow = 'hidden';
        });
      });
      function closeLB(){
        lb.classList.remove('open');
        lb.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
        lbImg.src = '';
      }
      lbClose.addEventListener('click', closeLB);
      lb.addEventListener('click', e => { if (e.target === lb) closeLB(); });
      window.addEventListener('keydown', e => { if (e.key === 'Escape') closeLB(); });
    })();
  </script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Project 1 — Detecting Brute Force Attacks with Splunk</title>
  <meta name="description" content="Detecting brute force attacks with Splunk: data ingest, searches, alerting, and dashboarding.">
  <style>
    :root{ --bg:#0f1016; --fg:#d7d7e0; --muted:#9f9fbc; --accent:#b8a1ff; --card:#131318; --border:#2a2a32; }
    html,body{
      margin:0; padding:0; background:var(--bg); color:var(--fg);
      font:15px/1.7 Helvetica, "Helvetica Neue", Arial, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
    .container{ max-width:860px; margin:32px auto 80px; padding:0 16px; }

    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    header{ padding:16px 0; }
    .back{ font-size:14px; color:var(--muted); }

    h1, h2 {
      font-family: "Avenir Next", Avenir, Montserrat, "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: #c9bbff;
    }

    p, li {
      font-family: "Source Code Pro", "Courier New", monospace;
      font-size: 15px;
      line-height: 1.6;
      color: #d7d7e0;
    }

    ul{ margin:8px 0 16px 20px; }
    hr{ border:0; border-top:1px solid var(--border); margin:24px 0; }

    .post figure{ margin:12px 0; }
    .post img{
      width:100%; max-width:860px;
      border:1px solid rgba(196,181,253,.18); border-radius:8px;
      display:block;
    }
    .post figcaption{
      font-size:12.5px; color:var(--muted); text-align:center; margin-top:6px;
    }
    .grid{ display:grid; gap:10px; }
    @media (min-width:800px){ .grid.two{ grid-template-columns:1fr 1fr; } }

    /* gallery + lightbox */
    .muted{ color:var(--muted); }
    .project-gallery{ margin-top:28px }
    .project-gallery h2{ color:var(--accent); margin-bottom:6px }
    .img-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(230px,1fr));
      gap:14px;
    }
    .img-grid figure{ margin:0 }
    .img-grid img{
      width:100%; height:auto; display:block; border-radius:10px;
      border:1px solid rgba(196,181,253,.18);
      box-shadow:0 4px 15px rgba(0,0,0,.25);
      cursor:zoom-in; transition:transform .2s ease, box-shadow .2s ease;
    }
    .img-grid img:hover{ transform:scale(1.04); box-shadow:0 8px 28px rgba(0,0,0,.45) }
    .img-grid figcaption{
      margin-top:6px; color:var(--muted); font-size:12.8px; text-align:center;
    }
    .lightbox{
      position:fixed; inset:0; display:none; place-items:center;
      background:rgba(0,0,0,.82); z-index:9999; padding:22px;
    }
    .lightbox.open{ display:grid }
    .lightbox img{
      max-width:min(1200px,92vw); max-height:86vh; border-radius:12px;
      box-shadow:0 10px 40px rgba(0,0,0,.6);
    }
    .lightbox .close{
      position:absolute; top:12px; right:16px; font-size:28px;
      color:#fff; cursor:pointer; line-height:1
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a class="back" href="/" aria-label="Back to home">← mariacybersec</a>
    </header>

    <main class="post">
      <h1>Detecting Brute Force Attacks with Splunk</h1>

      <p>Brute force attacks aren’t just random password guesses, they are high-volume authentication failures that leave a clear trail in system logs. In this project, I built a Splunk detection workflow to identify brute force activity, create automated alerts, and visualise the results in a dashboard.</p>

      <p>This was my first hands-on Splunk project, and here’s how I did it step by step:</p>

      <h2>Step 1: Ingest Authentication Logs</h2>
      <p>Before we can detect anything, Splunk needs the right data, so I ingested Linux authentication logs (linux_auth_demo) into a dedicated index called “lab”.</p>
      <p>I kept all test logs inside the lab index to avoid mixing them with production or default Splunk data.</p>

      <h2>Step 2: Search for Failed Logins</h2>
      <p>The raw logs contain both successful and failed login attempts. To isolate brute force behaviour, I searched for events with the keyword “Failed password”.</p>
      <p>This gave me individual failed login attempts, but brute force detection requires grouping them.</p>

      <h2>Step 3: Identify Suspicious Spikes</h2>
      <p>Afterwards, I built a query that groups failed logins by source IP (src) and counts them over time.</p>
      <p>This makes it easy to spot IPs generating bursts of failed logins within a short time window.</p>

      <h2>Step 4: Create a Real-Time Alert</h2>
      <p>Detecting is good, but alerts are what analysts rely on, therefore I converted the search into an alert:</p>
      <ul>
        <li><strong>Type:</strong> Real-time</li>
        <li><strong>Trigger:</strong> If failed login attempts exceed a threshold (for example: 5 in 5 minutes)</li>
        <li><strong>Throttle:</strong> By source IP (so we don’t get spammed)</li>
        <li><strong>Severity:</strong> High</li>
      </ul>
      <p>This ensures analysts are notified only when brute force activity truly looks suspicious, not just from a user typing a password once by mistake.</p>

      <h2>Step 5: Build a Dashboard Panel</h2>
      <p>Finally, I visualized the data in a Splunk dashboard panel:</p>
      <ul>
        <li><strong>X-axis:</strong> Time</li>
        <li><strong>Y-axis:</strong> Number of failed login attempts</li>
        <li><strong>Split by:</strong> Source IP</li>
      </ul>
      <p>This gives a clear at-a-glance picture of which IPs are hammering the system.</p>

      <h2>Step 6: Reduce False Positives</h2>
      <p>Not every spike is malicious, which is why I filtered out service accounts and test environments to avoid false positives and keep the focus on real brute force attempts.</p>

      <h2>Conclusion</h2>
      <p>This project has given me hands-on experience with Splunk search, alerting, and dashboarding. It has also taught me that brute force attacks are noisy, but without the right filtering, the alerts can drown analysts in false positives.</p>
      <ul>
        <li>Full SPL queries, alert configs, and screenshots are documented in this post.</li>
        <li>You can see my quick video summary on my Instagram <strong>@maria.cybersec</strong></li>
      </ul>

      <!-- === Project 1 Image Gallery (with captions) === -->
      <section class="project-gallery">
        <h2> Project Screenshots</h2>
        <p class="muted">A visual walkthrough of each step; from log ingestion to dashboard visualisation and alerting.</p>

        <div class="img-grid">
          <figure><img src="/assets/project1/1.jpg?v=1" alt="Create auth_demo.log"><figcaption>Step 1 — Create <code>auth_demo.log</code> in terminal</figcaption></figure>
          <figure><img src="/assets/project1/2.jpg?v=1" alt="Populate sample auth log entries"><figcaption>Step 2 — Populate sample auth log entries</figcaption></figure>
          <figure><img src="/assets/project1/3.jpg?v=1" alt="Add Data → Files & Directories"><figcaption>Step 3 — Add Data → Files & Directories</figcaption></figure>
          <figure><img src="/assets/project1/4.jpg?v=1" alt="Set source type & preview events"><figcaption>Step 4 — Set source type & preview events</figcaption></figure>
          <figure><img src="/assets/project1/5.jpg?v=1" alt="Input settings: host & index context"><figcaption>Step 5 — Input settings: host & index context</figcaption></figure>
          <figure><img src="/assets/project1/6.jpg?v=1" alt="Create the lab index"><figcaption>Step 6 — Create the <code>lab</code> index</figcaption></figure>
          <figure><img src="/assets/project1/7.jpg?v=1" alt="SPL stats: failed attempts by src"><figcaption>Step 7 — SPL stats: failed attempts by <code>src</code></figcaption></figure>
          <figure><img src="/assets/project1/8.jpg?v=1" alt="Refined SPL with rex & thresholds"><figcaption>Step 8 — Refined SPL with <code>rex</code> & thresholds</figcaption></figure>
          <figure><img src="/assets/project1/9.jpg?v=1" alt="Dashboard: failed logins over time"><figcaption>Step 9 — Dashboard: failed logins over time</figcaption></figure>
          <figure><img src="/assets/project1/10.jpg?v=1" alt="Panel config: fields & axes"><figcaption>Step 10 — Panel config: fields & axes</figcaption></figure>
          <figure><img src="/assets/project1/11.jpg?v=1" alt="Alert rule + throttle by src"><figcaption>Step 11 — Alert rule + throttle by <code>src</code></figcaption></figure>
          <figure><img src="/assets/project1/12.jpg?v=1" alt="Advanced alert settings"><figcaption>Step 12 — Advanced alert settings</figcaption></figure>
        </div>
      </section>

    </main>
  </div>

  <!-- Lightbox container -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <span class="close" id="lbClose" aria-label="Close">×</span>
    <img id="lbImg" alt="">
  </div>

  <script>
    (function(){
      const lb = document.getElementById('lightbox');
      const lbImg = document.getElementById('lbImg');
      const lbClose = document.getElementById('lbClose');
      document.querySelectorAll('.img-grid img').forEach(img=>{
        img.addEventListener('click',()=>{
          lbImg.src=img.dataset.full||img.src;
          lbImg.alt=img.alt||'';
          lb.classList.add('open');
          lb.setAttribute('aria-hidden','false');
          document.body.style.overflow='hidden';
        });
      });
      function closeLB(){
        lb.classList.remove('open');
        lb.setAttribute('aria-hidden','true');
        document.body.style.overflow='';
        lbImg.src='';
      }
      lbClose.addEventListener('click',closeLB);
      lb.addEventListener('click',e=>{if(e.target===lb)closeLB();});
      window.addEventListener('keydown',e=>{if(e.key==='Escape')closeLB();});
    })();
  </script>

  <h2>What’s next…?</h2>
      <p>In my second project, I’ll extend this by analyzing network traffic for unusual data exfiltration attempts.</p>
  
</body>
</html>

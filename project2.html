<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project 2 — Detecting DNS Exfiltration with Wireshark</title>
  <style>
    :root{
      --bg:#0b0b0c;         /* near-black background */
      --fg:#dcdcdc;         /* light gray text */
      --muted:#a9a9a9;      /* secondary text */
      --accent:#b8a1ff;     /* gentle purple */
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);}
    body{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:15px;              /* smaller, not kiddie-large */
      line-height:1.65;
      -webkit-font-smoothing:antialiased;
      max-width:880px;
      padding:32px 18px 80px;
      margin:0 auto;
    }
    header{margin-bottom:18px;}
    h1{
      font-size:24px;
      font-weight:700;
      color:var(--accent);
      margin:0 0 10px 0;
      letter-spacing:.2px;
    }
    .lede{color:var(--fg); margin:0 0 12px 0;}
    p{margin:10px 0;}
    h2{
      font-size:16px;
      color:var(--fg);
      margin:26px 0 10px;
    }
    strong{color:#fff;}
    u{text-decoration:underline;}
    ul{margin:8px 0 14px 18px;}
    li{margin:4px 0;}
    .muted{color:var(--muted);}
    a{color:var(--accent); text-decoration:none;}
    a:hover{ text-decoration:underline; }
    code{background:#131318; color:#eaeaea; padding:2px 5px; border-radius:4px;}
    hr{
      border:0; height:1px; background:#19191f; margin:28px 0;
    }
    footer{margin-top:28px; color:var(--muted); font-size:13px;}
    /* optional image styling (for later) */
    .img{margin:12px 0; border-radius:8px; display:block; max-width:100%; height:auto;}
    .small{font-size:13.5px;}
  </style>
</head>
<body>
  <header>
    <h1>Detecting DNS Exfiltration with Wireshark</h1>
    <p class="lede">DNS tunneling is a stealthy way attackers exfiltrate data through normal-looking DNS queries. In this mini lab, I simulated both normal and suspicious DNS traffic using Python + Scapy, then analyzed packet behavior in Wireshark to detect signs of data exfiltration.</p>
    <p class="lede">This is part 2 of my hands-on network forensics series — focused on identifying unusual DNS patterns that could indicate tunneling or data leaks.</p>
  </header>

  <h2>Step 1: Generate Simulated DNS Traffic</h2>
<p>I wrote a short Python script using <code>Scapy</code> to generate a <code>.pcap</code> file containing both normal DNS queries and suspicious, high-entropy subdomains that mimic exfiltration behavior. The file was then exported for Wireshark analysis.</p>

<h2>Step 2: Analyze the PCAP in Wireshark</h2>
<p>Opening the <code>project2_dns_tunnel.pcap</code> file, I inspected DNS packets and compared legitimate queries (<code>google.com</code>, <code>github.com</code>, etc.) with the generated suspicious traffic (<code>*.exfil.example</code>).</p>

<h2>Step 3: Observe Normal DNS Queries</h2>
<p>Normal traffic showed low-entropy, human-readable domain names and proper DNS responses. These packets represented standard user-initiated lookups.</p>

<h2>Step 4: Identify Suspicious Patterns</h2>
<p>Suspicious traffic displayed unusually long subdomains filled with random characters — a hallmark of data exfiltration via DNS tunneling. Many queries had no responses or incomplete exchanges, suggesting abnormal activity.</p>

<h2>Step 5: Compare Entropy & Behavior</h2>
<p>By visually comparing both patterns, I could confirm how tunneled data often looks chaotic compared to ordinary DNS traffic. Even without automation, this manual inspection highlights how analysts can spot covert channels.</p>

<h2>Step 6: Next Steps</h2>
<p>The next iteration will involve building a detection rule using Splunk or Zeek to automatically flag high-entropy DNS requests and sudden query bursts to non-standard domains.</p>

<hr />

<h2>Conclusion</h2>
<p>This lab deepened my understanding of how exfiltration can hide within legitimate protocols. Simulating and analyzing traffic hands-on provided an intuitive grasp of how DNS tunneling works and how to visualize it effectively in Wireshark.</p>
<ul>
  <li>All screenshots and packet captures are documented in this post.</li>
  <li>See my quick summary on Instagram <strong>@maria.cybersec</strong>.</li>
</ul>

<footer class="small">© mariacybersec</footer>
</body>
</html>

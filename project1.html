<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project 1 ‚Äî Detecting Brute Force Attacks with Splunk</title>
  <style>
    :root{
      --bg:#0b0b0c;         /* near-black background */
      --fg:#dcdcdc;         /* light gray text */
      --muted:#a9a9a9;      /* secondary text */
      --accent:#b8a1ff;     /* gentle purple */
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);}
    body{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:15px;              /* smaller, not kiddie-large */
      line-height:1.65;
      -webkit-font-smoothing:antialiased;
      max-width:880px;
      padding:32px 18px 80px;
      margin:0 auto;
    }
    header{margin-bottom:18px;}
    h1{
      font-size:24px;
      font-weight:700;
      color:var(--accent);
      margin:0 0 10px 0;
      letter-spacing:.2px;
    }
    .lede{color:var(--fg); margin:0 0 12px 0;}
    p{margin:10px 0;}
    h2{
      font-size:16px;
      color:var(--fg);
      margin:26px 0 10px;
    }
    strong{color:#fff;}
    u{text-decoration:underline;}
    ul{margin:8px 0 14px 18px;}
    li{margin:4px 0;}
    .muted{color:var(--muted);}
    a{color:var(--accent); text-decoration:none;}
    a:hover{ text-decoration:underline; }
    code{background:#131318; color:#eaeaea; padding:2px 5px; border-radius:4px;}
    hr{
      border:0; height:1px; background:#19191f; margin:28px 0;
    }
    footer{margin-top:28px; color:var(--muted); font-size:13px;}
    /* optional image styling (for later) */
    .img{margin:12px 0; border-radius:8px; display:block; max-width:100%; height:auto;}
    .small{font-size:13.5px;}
  </style>
</head>
<body>
  <header>
    <h1>Detecting Brute Force Attacks with Splunk</h1>
    <p class="lede">Brute force attacks aren‚Äôt just random password guesses, they are high-volume authentication failures that leave a clear trail in system logs. In this project, I built a Splunk detection workflow to identify brute force activity, create automated alerts, and visualise the results in a dashboard.</p>
    <p class="lede">This was my first hands-on Splunk project, and here‚Äôs how I did it step by step:</p>
  </header>

  <h2>Step 1: Ingest Authentication Logs</h2>
  <p>Before we can detect anything, Splunk needs the right data, so I ingested Linux authentication logs (<code>linux_auth_demo</code>) into a dedicated index called ‚Äúlab‚Äù.</p>
  <p>I kept all test logs inside the lab index to avoid mixing them with production or default Splunk data.</p>

  <h2>Step 2: Search for Failed Logins</h2>
  <p>The raw logs contain both successful and failed login attempts. To isolate brute force behaviour, I searched for events with the keyword ‚ÄúFailed password‚Äù:</p>
  <p>This gave me individual failed login attempts, but brute force detection requires grouping them.</p>

  <h2>Step 3: Identify Suspicious Spikes</h2>
  <p>Afterwards, I built a query that groups failed logins by source IP (src) and counts them over time:</p>
  <p>This makes it easy to spot IPs generating bursts of failed logins within a short time window.</p>

  <h2>Step 4: Create a Real-Time Alert</h2>
  <p>Detecting is good, but alerts are what analysts rely on, therefore I converted the search into an alert:</p>
  <ul>
    <li><strong>Type:</strong> Real-time</li>
    <li><strong>Trigger:</strong> If failed login attempts exceed a threshold (for example: 5 in 5 minutes)</li>
    <li><strong>Throttle:</strong> By source IP (so we don‚Äôt get spammed)</li>
    <li><strong>Severity:</strong> High</li>
  </ul>
  <p>This ensures analysts are notified only when brute force activity truly looks suspicious, not just from a user typing a password once by mistake.</p>

  <h2>Step 5: Build a Dashboard Panel</h2>
  <p>Finally, I visualized the data in a Splunk dashboard panel:</p>
  <ul>
    <li><strong>X-axis:</strong> Time</li>
    <li><strong>Y-axis:</strong> Number of failed login attempts</li>
    <li><strong>Split by:</strong> Source IP</li>
  </ul>
  <p>This gives a clear at-a-glance picture of which IPs are hammering the system.</p>

  <h2>Step 6: Reduce False Positives</h2>
  <p>Not every spike is malicious, which is why I filtered out service accounts and test environments to avoid false positives and keep the focus on real brute force attempts.</p>

  <hr />

  <h2>Conclusion</h2>
  <p>This project has given me me hands-on experience with Splunk search, alerting, and dashboarding. It has also taught me that brute force attacks are noisy, but without the right filtering, the alerts can drown analysts in false positives.</p>
  <ul>
    <li>Full SPL queries, alert configs, and screenshots are documented in this post.</li>
    <li>You can see my quick video summary on my Instagram <strong>@maria.cybersec</strong></li>
  </ul>

  <p><strong>What‚Äôs next‚Ä¶?</strong></p>
  <p>In my second project, I‚Äôll extend this by analyzing network traffic for unusual data exfiltration attempts.</p>

  <!-- === Project 1 Image Gallery (with captions) === -->
<section class="project-gallery">
  <h2>üì∏ Project Screenshots</h2>
  <p class="muted">A visual walkthrough of each step ‚Äî from log ingestion to dashboard visualization and alert configuration.</p>

  <div class="img-grid">
    <figure>
      <img loading="lazy" src="../assets/project1/1.jpg" alt="Create auth_demo.log in terminal" data-full="../assets/project1/1.jpg">
      <figcaption>Step 1 ‚Äî Create <code>auth_demo.log</code> in terminal</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/2.jpg" alt="Populate sample auth log entries" data-full="../assets/project1/2.jpg">
      <figcaption>Step 2 ‚Äî Populate sample auth log entries</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/3.jpg" alt="Add Data ‚Üí Files & Directories" data-full="../assets/project1/3.jpg">
      <figcaption>Step 3 ‚Äî Add Data ‚Üí Files & Directories</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/4.jpg" alt="Set Source Type and preview events" data-full="../assets/project1/4.jpg">
      <figcaption>Step 4 ‚Äî Set source type & preview events</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/5.jpg" alt="Input settings: host and index context" data-full="../assets/project1/5.jpg">
      <figcaption>Step 5 ‚Äî Input settings: host & index context</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/6.jpg" alt="Create the lab index (Events)" data-full="../assets/project1/6.jpg">
      <figcaption>Step 6 ‚Äî Create the <code>lab</code> index (Events)</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/7.jpg" alt="SPL statistics: failed attempts by src" data-full="../assets/project1/7.jpg">
      <figcaption>Step 7 ‚Äî SPL stats: failed attempts by <code>src</code></figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/8.jpg" alt="Refined SPL search with rex and thresholds" data-full="../assets/project1/8.jpg">
      <figcaption>Step 8 ‚Äî Refined SPL with <code>rex</code> & thresholds</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/9.jpg" alt="Dashboard panel: failed logins over time" data-full="../assets/project1/9.jpg">
      <figcaption>Step 9 ‚Äî Dashboard: failed logins over time</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/10.jpg" alt="Panel configuration: fields and axes" data-full="../assets/project1/10.jpg">
      <figcaption>Step 10 ‚Äî Panel config: fields & axes</figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/11.jpg" alt="Alert rule with throttling by src" data-full="../assets/project1/11.jpg">
      <figcaption>Step 11 ‚Äî Alert rule + throttle by <code>src</code></figcaption>
    </figure>

    <figure>
      <img loading="lazy" src="../assets/project1/12.jpg" alt="Advanced alert settings (email action etc.)" data-full="../assets/project1/12.jpg">
      <figcaption>Step 12 ‚Äî Advanced alert settings</figcaption>
    </figure>
  </div>
</section>

<style>
  .project-gallery{margin-top:60px}
  .project-gallery h2{color:var(--accent);margin-bottom:8px}
  .project-gallery .muted{color:var(--muted);margin-bottom:20px}

  .img-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(230px,1fr));
    gap:16px;
  }
  figure{margin:0}
  figure img{
    width:100%; height:auto; display:block; border-radius:10px;
    box-shadow:0 4px 15px rgba(0,0,0,.3);
    cursor:zoom-in; transition:transform .25s ease, box-shadow .25s ease;
  }
  figure img:hover{ transform:scale(1.06); box-shadow:0 8px 30px rgba(0,0,0,.5) }
  figcaption{
    margin-top:8px; color:var(--muted); font-size:13.5px; line-height:1.45
  }

  /* Lightbox */
  .lightbox{
    position:fixed; inset:0; display:none; place-items:center;
    background:rgba(0,0,0,.82); z-index:9999; padding:22px;
  }
  .lightbox.open{ display:grid }
  .lightbox img{
    max-width:min(1200px,92vw); max-height:86vh; border-radius:12px;
    box-shadow:0 10px 40px rgba(0,0,0,.6);
  }
  .lightbox .close{
    position:absolute; top:14px; right:16px; font-size:28px;
    color:#fff; cursor:pointer; line-height:1
  }
</style>
  
<footer class="small">¬© mariacybersec</footer>

  <!-- Lightbox container + script go here -->
  <div class="lightbox" id="lightbox">
    <span class="close" id="lbClose" aria-label="Close">√ó</span>
    <img id="lbImg" alt="">
  </div>

  <script>
    // open lightbox on click
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbClose = document.getElementById('lbClose');

    document.querySelectorAll('.img-grid img').forEach(img => {
      img.addEventListener('click', () => {
        lbImg.src = img.dataset.full || img.src;
        lbImg.alt = img.alt || '';
        lb.classList.add('open');
        document.body.style.overflow = 'hidden';
      });
    });

    // close on X, backdrop, or ESC
    function closeLB(){
      lb.classList.remove('open');
      document.body.style.overflow = '';
      lbImg.src = '';
    }
    lbClose.addEventListener('click', closeLB);
    lb.addEventListener('click', e => { if (e.target === lb) closeLB(); });
    window.addEventListener('keydown', e => { if (e.key === 'Escape') closeLB(); });
  </script>

</body>
</html>
